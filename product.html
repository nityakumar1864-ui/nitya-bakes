<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Catalogue — Whimsy Cakes</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--text:#3b2f2f}
  *{box-sizing:border-box}
  body{margin:0;font-family:"Quicksand",sans-serif;background:linear-gradient(135deg,#dffaf0,#f0e9ff,#fff0e6);min-height:100vh}
  .wrap{max-width:1100px;margin:28px auto;padding:20px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px}
  .card{border-radius:14px;padding:18px;background:linear-gradient(180deg,rgba(255,255,255,0.6),rgba(255,255,255,0.35));backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,0.6)}
  .card img{width:100%;height:140px;object-fit:cover;border-radius:10px}
  .meta{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
  .price{font-weight:800}
  .btn{padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700;background:linear-gradient(90deg,#b7ffd8,#d8c8ff)}
  .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .mini{font-size:13px;opacity:.86}
  .summaryBox{margin-top:16px;padding:14px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.5),rgba(255,255,255,0.3));}
  @media(max-width:720px){.topbar{flex-direction:column;gap:8px;align-items:flex-start}}
</style>
</head>
<body>
<div class="wrap">
  <div class="topbar">
    <div>
      <div style="font-family:Pacifico;font-size:20px;color:#5a3e6b">Whimsy Cakes • Catalogue</div>
      <div class="mini">Choose the product that matches your customization</div>
    </div>
    <div>
      <button class="btn" onclick="location.href='quote.html'">Edit Quote</button>
    </div>
  </div>

  <div class="grid" id="catalogueGrid">
    <!-- generated cards -->
  </div>

  <div class="summaryBox" id="orderSummary" style="display:none">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div>
        <div style="font-size:13px;opacity:.85">Selected</div>
        <div id="selTitle" style="font-weight:800"></div>
        <div id="selDetails" style="opacity:.85;font-size:13px"></div>
      </div>
      <div style="text-align:right">
        <div style="font-size:13px;opacity:.85">Total</div>
        <div id="selPrice" style="font-weight:900;font-size:20px"></div>
        <div style="margin-top:8px"><button class="btn" id="toPayment">Proceed to Payment</button></div>
      </div>
    </div>
  </div>
</div>

<script>
  // price mapping
  const base = { "1":600,"2":1100,"3":1600 };
  // sample product images (unsplash) - offline usage fine, but images use unsplash urls
  const images = {
    "Chocolate":"https://images.unsplash.com/photo-1542831371-d531d36971e6?auto=format&fit=crop&w=800&q=60",
    "Vanilla":"https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=60",
    "Red Velvet":"https://images.unsplash.com/photo-1559628233-6d6db6b6fd6f?auto=format&fit=crop&w=800&q=60",
    "Strawberry":"https://images.unsplash.com/photo-1563805042-7684c019e1cb?auto=format&fit=crop&w=800&q=60"
  };

  // load quote
  let q = localStorage.getItem('whimsy_quote');
  if(!q){ // fallback - small default
    q = JSON.stringify({weight:"1",flavour:"Chocolate",message:"",filling:"Buttercream",style:"Minimal Pastel",extras:{}});
  }
  const quote = JSON.parse(q);

  // create catalogue options based on weight tiers
  const grid = document.getElementById('catalogueGrid');
  const weights = ["1","2","3"];
  weights.forEach(w => {
    const priceBase = base[w];
    // build card element
    const card = document.createElement('div');
    card.className = 'card';
    const imgSrc = images[quote.flavour] || images['Chocolate'];
    card.innerHTML = `
      <img src="${imgSrc}" alt="cake ${w}kg" />
      <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:800">${w} kg • ${quote.flavour}</div>
          <div style="font-size:13px;opacity:.86">${quote.style} • ${quote.filling}</div>
        </div>
        <div style="text-align:right">
          <div class="price">₹${priceBase}</div>
          <div style="font-size:12px;opacity:.8">Est.</div>
        </div>
      </div>
      <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end">
        <button class="btn" onclick="selectProduct('${w}')">Select</button>
      </div>
    `;
    grid.appendChild(card);
  });

  // selection handling
  function computeExtras() {
    const ex = quote.extras || {};
    let e = 0;
    if(ex.flowers) e += 250;
    if(ex.topper) e += 350;
    if(ex.rush) e += 500;
    if(ex.cupcakes) e += 400;
    return e;
  }

  function selectProduct(weight){
    const price = base[weight] + computeExtras();
    // store order in localStorage
    const order = {
      weight, flavour: quote.flavour, filling: quote.filling, style: quote.style, message: quote.message, extras: quote.extras || {},
      price
    };
    localStorage.setItem('whimsy_order', JSON.stringify(order));
    // show summary box
    document.getElementById('orderSummary').style.display = 'block';
    document.getElementById('selTitle').textContent = `${weight} kg • ${quote.flavour}`;
    const extrasList = [];
    if(order.extras.flowers) extrasList.push('Fresh Flowers');
    if(order.extras.topper) extrasList.push('Custom Topper');
    if(order.extras.rush) extrasList.push('Rush');
    if(order.extras.cupcakes) extrasList.push('Cupcake Box');
    document.getElementById('selDetails').textContent = (extrasList.length?extrasList.join(', '):'No extras') + (order.message?(' • "'+order.message+'"'):'');
    document.getElementById('selPrice').textContent = '₹' + price;
    window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
  }

  document.getElementById('toPayment').addEventListener('click', ()=>{
    window.location.href = 'payment.html';
  });
</script>
</body>
</html>
